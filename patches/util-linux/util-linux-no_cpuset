--- include/path.h.orig	2012-09-20 07:08:25.000000000 -0300
+++ include/path.h	2012-10-18 12:41:02.000000000 -0300
@@ -10,8 +10,4 @@
 		       __attribute__ ((__format__ (__printf__, 1, 2)));
 extern int path_exist(const char *path, ...)
 		      __attribute__ ((__format__ (__printf__, 1, 2)));
-extern cpu_set_t *path_cpuset(int, const char *path, ...)
-			      __attribute__ ((__format__ (__printf__, 2, 3)));
-extern cpu_set_t *path_cpulist(int, const char *path, ...)
-			       __attribute__ ((__format__ (__printf__, 2, 3)));
 extern void path_setprefix(const char *);
--- lib/Makemodule.am.orig	2012-09-20 10:16:51.000000000 -0300
+++ lib/Makemodule.am	2012-10-18 12:41:02.000000000 -0300
@@ -5,7 +5,6 @@
 	lib/at.c \
 	lib/blkdev.c \
 	lib/canonicalize.c \
-	lib/cpuset.c \
 	lib/crc32.c \
 	lib/env.c \
 	lib/fileutils.c \
@@ -50,7 +49,7 @@
 
 if LINUX
 if HAVE_CPU_SET_T
-check_PROGRAMS += test_cpuset
+check_PROGRAMS += :
 endif
 check_PROGRAMS += \
 	test_sysfs \
--- lib/path.c.orig	2012-09-20 10:16:51.000000000 -0300
+++ lib/path.c	2012-10-18 12:41:02.000000000 -0300
@@ -28,7 +28,6 @@
 #include <errno.h>
 
 #include "all-io.h"
-#include "cpuset.h"
 #include "path.h"
 #include "nls.h"
 #include "c.h"
@@ -151,64 +150,6 @@
 	return access(p, F_OK) == 0;
 }
 
-static cpu_set_t *
-path_cpuparse(int maxcpus, int islist, const char *path, va_list ap)
-{
-	FILE *fd;
-	cpu_set_t *set;
-	size_t setsize, len = maxcpus * 7;
-	char buf[len];
-
-	fd = path_vfopen("r", 1, path, ap);
-
-	if (!fgets(buf, len, fd))
-		err(EXIT_FAILURE, _("failed to read: %s"), pathbuf);
-	fclose(fd);
-
-	len = strlen(buf);
-	if (buf[len - 1] == '\n')
-		buf[len - 1] = '\0';
-
-	set = cpuset_alloc(maxcpus, &setsize, NULL);
-	if (!set)
-		err(EXIT_FAILURE, _("failed to callocate cpu set"));
-
-	if (islist) {
-		if (cpulist_parse(buf, set, setsize, 0))
-			errx(EXIT_FAILURE, _("failed to parse CPU list %s"), buf);
-	} else {
-		if (cpumask_parse(buf, set, setsize))
-			errx(EXIT_FAILURE, _("failed to parse CPU mask %s"), buf);
-	}
-	return set;
-}
-
-cpu_set_t *
-path_cpuset(int maxcpus, const char *path, ...)
-{
-	va_list ap;
-	cpu_set_t *set;
-
-	va_start(ap, path);
-	set = path_cpuparse(maxcpus, 0, path, ap);
-	va_end(ap);
-
-	return set;
-}
-
-cpu_set_t *
-path_cpulist(int maxcpus, const char *path, ...)
-{
-	va_list ap;
-	cpu_set_t *set;
-
-	va_start(ap, path);
-	set = path_cpuparse(maxcpus, 1, path, ap);
-	va_end(ap);
-
-	return set;
-}
-
 void
 path_setprefix(const char *prefix)
 {
--- Makefile.in.orig	2012-10-10 10:00:54.000000000 -0300
+++ Makefile.in	2012-10-18 12:41:52.000000000 -0300
@@ -686,7 +686,7 @@
 @BUILD_LIBBLKID_TRUE@am_libblkid_la_rpath = -rpath $(usrlib_execdir)
 libcommon_la_LIBADD =
 am__libcommon_la_SOURCES_DIST = lib/at.c lib/blkdev.c \
-	lib/canonicalize.c lib/cpuset.c lib/crc32.c lib/env.c \
+	lib/canonicalize.c lib/crc32.c lib/env.c \
 	lib/fileutils.c lib/ismounted.c lib/mangle.c lib/match.c \
 	lib/mbsalign.c lib/md5.c lib/pager.c lib/path.c \
 	lib/procutils.c lib/randutils.c lib/setproctitle.c \
@@ -698,7 +698,7 @@
 @HAVE_LANGINFO_FALSE@am__objects_3 = lib/libcommon_la-langinfo.lo
 am_libcommon_la_OBJECTS = lib/libcommon_la-at.lo \
 	lib/libcommon_la-blkdev.lo lib/libcommon_la-canonicalize.lo \
-	lib/libcommon_la-cpuset.lo lib/libcommon_la-crc32.lo \
+	lib/libcommon_la-crc32.lo \
 	lib/libcommon_la-env.lo lib/libcommon_la-fileutils.lo \
 	lib/libcommon_la-ismounted.lo lib/libcommon_la-mangle.lo \
 	lib/libcommon_la-match.lo lib/libcommon_la-mbsalign.lo \
@@ -2552,7 +2552,7 @@
 pkgconfigdir = $(usrlib_execdir)/pkgconfig
 dist_noinst_HEADERS = include/all-io.h include/at.h include/bitops.h \
 	include/blkdev.h include/c.h include/canonicalize.h \
-	include/carefulputc.h include/closestream.h include/cpuset.h \
+	include/carefulputc.h include/closestream.h \
 	include/crc32.h include/env.h include/exitcodes.h \
 	include/fileutils.h include/ismounted.h include/linux_reboot.h \
 	include/linux_version.h include/list.h include/loopdev.h \
@@ -2626,7 +2626,7 @@
 ACLOCAL_AMFLAGS = -I m4
 libcommon_la_CFLAGS = $(AM_CFLAGS)
 libcommon_la_SOURCES = lib/at.c lib/blkdev.c lib/canonicalize.c \
-	lib/cpuset.c lib/crc32.c lib/env.c lib/fileutils.c \
+	lib/crc32.c lib/env.c lib/fileutils.c \
 	lib/ismounted.c lib/mangle.c lib/match.c lib/mbsalign.c \
 	lib/md5.c lib/pager.c lib/path.c lib/procutils.c \
 	lib/randutils.c lib/setproctitle.c lib/strutils.c lib/sysfs.c \
@@ -3749,8 +3749,6 @@
 	lib/$(DEPDIR)/$(am__dirstamp)
 lib/libcommon_la-canonicalize.lo: lib/$(am__dirstamp) \
 	lib/$(DEPDIR)/$(am__dirstamp)
-lib/libcommon_la-cpuset.lo: lib/$(am__dirstamp) \
-	lib/$(DEPDIR)/$(am__dirstamp)
 lib/libcommon_la-crc32.lo: lib/$(am__dirstamp) \
 	lib/$(DEPDIR)/$(am__dirstamp)
 lib/libcommon_la-env.lo: lib/$(am__dirstamp) \
@@ -5251,7 +5249,6 @@
 	-rm -f lib/libcommon_la-canonicalize.$(OBJEXT)
 	-rm -f lib/libcommon_la-canonicalize.lo
 	-rm -f lib/libcommon_la-cpuset.$(OBJEXT)
-	-rm -f lib/libcommon_la-cpuset.lo
 	-rm -f lib/libcommon_la-crc32.$(OBJEXT)
 	-rm -f lib/libcommon_la-crc32.lo
 	-rm -f lib/libcommon_la-env.$(OBJEXT)
@@ -6671,13 +6668,6 @@
 @AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
 @am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(LIBTOOL) $(AM_V_lt) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libcommon_la_CFLAGS) $(CFLAGS) -c -o lib/libcommon_la-canonicalize.lo `test -f 'lib/canonicalize.c' || echo '$(srcdir)/'`lib/canonicalize.c
 
-lib/libcommon_la-cpuset.lo: lib/cpuset.c
-@am__fastdepCC_TRUE@	$(AM_V_CC)$(LIBTOOL) $(AM_V_lt) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libcommon_la_CFLAGS) $(CFLAGS) -MT lib/libcommon_la-cpuset.lo -MD -MP -MF lib/$(DEPDIR)/libcommon_la-cpuset.Tpo -c -o lib/libcommon_la-cpuset.lo `test -f 'lib/cpuset.c' || echo '$(srcdir)/'`lib/cpuset.c
-@am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) lib/$(DEPDIR)/libcommon_la-cpuset.Tpo lib/$(DEPDIR)/libcommon_la-cpuset.Plo
-@AMDEP_TRUE@@am__fastdepCC_FALSE@	$(AM_V_CC)source='lib/cpuset.c' object='lib/libcommon_la-cpuset.lo' libtool=yes @AMDEPBACKSLASH@
-@AMDEP_TRUE@@am__fastdepCC_FALSE@	DEPDIR=$(DEPDIR) $(CCDEPMODE) $(depcomp) @AMDEPBACKSLASH@
-@am__fastdepCC_FALSE@	$(AM_V_CC@am__nodep@)$(LIBTOOL) $(AM_V_lt) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libcommon_la_CFLAGS) $(CFLAGS) -c -o lib/libcommon_la-cpuset.lo `test -f 'lib/cpuset.c' || echo '$(srcdir)/'`lib/cpuset.c
-
 lib/libcommon_la-crc32.lo: lib/crc32.c
 @am__fastdepCC_TRUE@	$(AM_V_CC)$(LIBTOOL) $(AM_V_lt) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=compile $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(libcommon_la_CFLAGS) $(CFLAGS) -MT lib/libcommon_la-crc32.lo -MD -MP -MF lib/$(DEPDIR)/libcommon_la-crc32.Tpo -c -o lib/libcommon_la-crc32.lo `test -f 'lib/crc32.c' || echo '$(srcdir)/'`lib/crc32.c
 @am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) lib/$(DEPDIR)/libcommon_la-crc32.Tpo lib/$(DEPDIR)/libcommon_la-crc32.Plo
