--- src/libFLAC/stream_decoder.c.orig	2014-11-25 13:41:50.280032892 +0200
+++ src/libFLAC/stream_decoder.c	2014-11-25 13:46:21.862277460 +0200
@@ -2726,7 +2726,8 @@
 		if(decoder->private_->frame.header.blocksize < predictor_order) {
 			send_error_to_client_(decoder, FLAC__STREAM_DECODER_ERROR_STATUS_LOST_SYNC);
 			decoder->protected_->state = FLAC__STREAM_DECODER_SEARCH_FOR_FRAME_SYNC;
-			return true;
+                	/* We have received a potentially malicious bt stream. All we can do is error out to avoid a heap overflow. */
+	                return false;
 		}
 	}
 	else {
